<!-- property-details.component.html -->
<div class="property-details-container">
  <!-- Header -->
  <header class="property-header">
    <button class="back-button" (click)="goBack()">
      <i class="fas fa-chevron-left"></i>
      Back
    </button>
    <!-- Actions removed as per request -->
  </header>

  <!-- Image Gallery -->
  <div class="image-gallery">
    <div class="main-image">
      <img alt="" [src]="property.images[selectedImageIndex]" [alt]="property.name">
    </div>
    <div class="thumbnail-grid">
      <div *ngFor="let image of property.images; let i = index" class="thumbnail"
        [class.active]="i === selectedImageIndex" (click)="selectImage(i)">
        <img alt="" [src]="image" [alt]="property.name + ' image ' + (i + 1)">
      </div>
    </div>
    <button class="view-all-photos">
      <i class="fas fa-camera"></i> Show all photos
    </button>
  </div>

  <!-- Property Info Section -->
  <div class="property-content">
    <div class="main-content">
      <!-- Property Header -->
      <div class="property-info-header">
        <h1>{{ property.name }}</h1>
        <div class="property-rating">
          <span class="stars">★</span>
          <span class="rating">{{ property.rating }}</span>
          <span class="reviews">({{ property.reviewCount }} reviews)</span>
        </div>
        <p class="property-location">
          <i class="fas fa-map-marker-alt"></i> {{ property.location }}
        </p>
      </div>

      <!-- Property Highlights -->
      <div class="property-highlights">
        <div class="highlight-item" *ngFor="let highlight of property.highlights">
          <i class="fas fa-check-circle"></i> {{ highlight }}
        </div>
      </div>

      <!-- Property Details -->
      <div class="property-details-grid">
        <div class="detail-item">
          <i class="fas fa-home"></i>
          <div>
            <strong>{{ property.type }}</strong>
            <span>Entire place to yourself</span>
          </div>
        </div>
        <div class="detail-item">
          <i class="fas fa-user-friends"></i>
          <div>
            <strong>Up to {{ property.maxGuests }} guests</strong>
            <span>{{ property.bedrooms }} bedrooms · {{ property.beds }} beds · {{ property.bathrooms }} baths</span>
          </div>
        </div>
      </div>

      <!-- Amenities -->
      <div class="amenities-section">
        <h2>What this place offers</h2>
        <div class="amenities-grid">
          <div class="amenity-item"
            *ngFor="let amenity of (showAllAmenities ? property.amenities : property.amenities.slice(0, 6))">
            <i class="fas fa-check"></i> {{ amenity }}
          </div>
        </div>
        <button class="show-more-btn" (click)="toggleAmenities()">
          {{ showAllAmenities ? 'Show less' : 'Show all amenities' }}
        </button>
      </div>

      <!-- Description -->
      <div class="description-section">
        <h2>About this place</h2>
        <p>{{ property.description }}</p>
      </div>

      <!-- Reviews -->
      <!-- Reviews -->
      <!-- Reviews -->
      <div class="reviews-section" *ngIf="property">
        <app-review-list [itemId]="property.id" type="property"></app-review-list>

        <button class="write-review-btn mt-4" *ngIf="hasBooking" (click)="openReviewModal()">
          <i class="fas fa-pen"></i> Write request a review
        </button>
      </div>

      <!-- Review Modal -->
      <div class="modal-overlay" *ngIf="showReviewModal" (click)="closeReviewModal()">
        <div class="modal-content" (click)="$event.stopPropagation()">
          <div style="display: flex; justify-content: flex-end;">
            <button (click)="closeReviewModal()" class="text-gray-500 hover:text-gray-700">✕</button>
          </div>
          <app-review-form [itemId]="property.id" type="property" (reviewSubmitted)="onReviewSubmitted()">
          </app-review-form>
        </div>
      </div>

      <!-- Host Info -->
      <div class="host-section">
        <h2>Hosted by {{ property.host.name }}</h2>
        <div class="host-info">
          <img alt="" [src]="property.host.avatar" [alt]="property.host.name" class="host-avatar">
          <div class="host-details">
            <div class="host-badge" *ngIf="property.host.isSuperhost">
              <i class="fas fa-medal"></i> Superhost
            </div>
            <p>Joined in {{ property.host.joinedDate }}</p>
          </div>
        </div>
        <button class="contact-host-btn">Contact Host</button>
      </div>
    </div>

    <!-- Booking Widget -->
    <div class="booking-widget">
      <div class="price-section">
        <span class="price">${{ property.price }}</span>
        <span class="period">night</span>
      </div>

      <div class="date-selector">
        <div class="date-input">
          <label>CHECK-IN</label>
          <input name="" title="l" alt="" type="date" [(ngModel)]="checkInDate">
        </div>
        <div class="date-input">
          <label>CHECKOUT</label>
          <input title="l" alt="" type="date" [(ngModel)]="checkOutDate">
        </div>
      </div>

      <div class="guests-selector">
        <label>GUESTS</label>
        <select title="guests" name="guests" [(ngModel)]="guests">
          <option *ngFor="let num of [1,2,3,4]" [value]="num">{{ num }} guest{{ num > 1 ? 's' : '' }}</option>
        </select>
      </div>

      <button class="reserve-btn" (click)="reserveProperty()">Reserve</button>

      <div class="price-breakdown">
        <div class="price-item">
          <span>${{ property.price }} x 5 nights</span>
          <span>${{ property.price * 5 }}</span>
        </div>
        <div class="price-item">
          <span>Cleaning fee</span>
          <span>$50</span>
        </div>
        <div class="price-item">
          <span>Service fee</span>
          <span>$30</span>
        </div>
        <div class="price-total">
          <strong>Total</strong>
          <strong>${{ property.price * 5 + 80 }}</strong>
        </div>
      </div>
    </div>
  </div>
</div>
